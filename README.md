# HSGUI - Helper Script GUI

**Версия:** 0.1.5

Графический интерфейс для управления 3D-принтерами Creality через SSH. Основан на оригинальном [Creality-Helper-Script](https://github.com/Guilouz/Creality-Helper-Script.git).

---

## О программе

HSGUI (Helper Script GUI) - это настольное приложение для Windows, Linux и macOS, которое предоставляет удобный графический интерфейс для управления принтерами Creality. Программа позволяет устанавливать и настраивать компоненты, управлять сервисами, создавать резервные копии и выполнять диагностику системы принтера через SSH соединение.

### Назначение

Программа предназначена для:
- Упрощения установки и настройки компонентов на принтерах Creality
- Централизованного управления всеми аспектами работы принтера
- Автоматизации рутинных операций (установка, удаление, резервное копирование)
- Мониторинга состояния системы принтера
- Диагностики проблем и управления сервисами

---

## Системные требования

### Операционные системы
- Windows 10/11 (x64)
- Linux (x64) - Ubuntu 18.04+, Debian 10+, или совместимые дистрибутивы
- macOS 10.14+ (x64/ARM64)

### Сетевое подключение
- Принтер должен быть доступен по сети через SSH
- Стандартные учетные данные SSH: root / creality_2023

---

## Поддерживаемые принтеры

Программа автоматически определяет следующие модели принтеров:

**Серия K1:**
- Creality K1
- Creality K1 Max
- Creality K1C
- Creality K1SE
- Creality K1S

**Серия Ender-3 V3:**
- Ender-3 V3
- Ender-3 V3 SE
- Ender-3 V3 KE

**Другие модели:**
- Ender 5 Max (E5M)

---

## Установка

### Скачивание релиза

1. Перейдите на страницу [Releases](https://github.com/Tombraider2006/HSGUI_TT/releases)
2. Скачайте установщик для вашей операционной системы:
   - Windows: `HSGUI - Creality Helper Setup X.X.X.exe`
   - Linux: `hsgui-X.X.X.AppImage`
   - macOS: `HSGUI - Creality Helper-X.X.X.dmg`
3. Запустите установщик и следуйте инструкциям

**Все доступные релизы:** [GitHub Releases](https://github.com/Tombraider2006/HSGUI_TT/releases)

---

## Руководство по использованию

### Подключение к принтеру

1. **Главная страница** - введите данные для подключения:
   - IP адрес принтера (например: 192.168.1.100)
   - Порт SSH (по умолчанию: 22)
   - Имя пользователя (по умолчанию: root)
   - Пароль (по умолчанию: creality_2023)

2. Нажмите кнопку "Подключиться"

3. Программа автоматически определит модель принтера и отобразит её в статусной строке

4. При необходимости можно выбрать модель вручную из выпадающего списка в шапке приложения

### Очистка SSH ключей

Если возникают проблемы с подключением из-за изменений в SSH ключах хоста, используйте кнопку "Очистить SSH" для удаления сохраненных ключей.

---

## Описание разделов меню

### Главная

**Назначение:** Подключение к принтеру и базовая информация

**Функции:**
- Форма подключения к принтеру через SSH
- Автоматическое определение модели принтера
- Ручной выбор модели из списка
- Кнопка автоопределения модели
- Очистка SSH ключей хоста
- Отображение статуса подключения

**Использование:**
После успешного подключения статусная строка отобразит зеленый индикатор и название модели принтера. Все остальные разделы меню станут доступны для работы.

---

### Установка компонентов

**Назначение:** Установка дополнительных компонентов на принтер

**Доступные компоненты:**

**Основные компоненты:**
- **Moonraker и Nginx** - веб-сервер и API для управления принтером через браузер. Необходим для работы веб-интерфейсов.
- **Fluidd** - современный веб-интерфейс для управления принтером (порт 4408). Альтернатива стандартному интерфейсу Creality.
- **Mainsail** - альтернативный веб-интерфейс (порт 4409). Второй вариант веб-интерфейса.

**Пакетный менеджер:**
- **Entware** - система управления пакетами для установки дополнительного программного обеспечения на принтер.

**Компоненты Klipper:**
- **Klipper Gcode Shell Command** - позволяет выполнять команды оболочки из G-кода. Необходим для работы многих макросов.
- **KAMP (Klipper Adaptive Meshing & Purging)** - улучшенная калибровка стола и автоматическая очистка сопла перед печатью.
- **Useful Macros** - набор полезных макросов для повседневной работы.
- **Save Z-Offset** - автоматическое сохранение и загрузка Z-смещения.

**Оборудование:**
- **Buzzer Support** - поддержка звуковых оповещений. Внимание: не работает на моделях K1S и K1SE.
- **Nozzle Cleaning Fan Control** - автоматическое управление вентиляторами при очистке сопла.
- **Fans Control Macros** - расширенное управление вентиляторами материнской платы через веб-интерфейс.

**Улучшения:**
- **Improved Shapers** - улучшенные алгоритмы виброкомпенсации для более точной печати.

**Резервное копирование:**
- **Git Backup** - автоматическое резервное копирование конфигурации в Git репозиторий.

**Камера:**
- **Camera Settings** - настройки камеры для интеграции с Moonraker.
- **USB Camera** - поддержка USB камер для видеонаблюдения за печатью.

**Удаленное управление:**
- **OctoEverywhere** - удаленный доступ к принтеру через интернет.
- **Moonraker Obico** - интеграция с облачным сервисом Obico.
- **SimplyPrint** - облачный сервис для управления принтером.

**Мобильные приложения:**
- **Mobileraker** - мобильное приложение для управления принтером.
- **OctoApp** - мобильное приложение с расширенными функциями.

**Дополнительно:**
- **Moonraker Timelapse** - создание таймлапсов печати.
- **Screws Tilt Adjust** - помощь в калибровке стола через регулировочные винты.
- **M600 Support** - поддержка команды M600 (смена филамента).

**Использование:**
1. Выберите модель принтера из списка (если не определена автоматически)
2. Отметьте нужные компоненты для установки
3. Используйте кнопки "Выбрать все" или "Снять выделение" для массового выбора
4. Нажмите "Установить выбранные" для начала установки
5. Следите за прогрессом в логе установки

**Примечание:** Некоторые компоненты могут быть недоступны для определенных моделей принтеров. Программа автоматически скрывает несовместимые компоненты.

---

### Удаление компонентов

**Назначение:** Удаление ранее установленных компонентов с принтера

**Функции:**
- Автоматическое определение установленных компонентов
- Массовое удаление выбранных компонентов
- Логирование процесса удаления
- Подтверждение перед удалением

**Использование:**
1. Перейдите в раздел "Удаление"
2. Дождитесь загрузки списка установленных компонентов
3. Отметьте компоненты, которые необходимо удалить
4. Нажмите "Удалить выбранные"
5. Подтвердите действие в диалоговом окне
6. Следите за прогрессом в логе удаления

**Внимание:** Удаление некоторых компонентов может повлиять на работу других установленных компонентов. Убедитесь, что удаляемые компоненты не требуются для работы системы.

---

### Настройка компонентов

**Назначение:** Мониторинг и управление системой принтера

**Разделы:**

**Информация о системе:**
- Модель принтера
- Версия ядра Linux
- Версии установленного ПО (Klipper, Moonraker, Fluidd, Mainsail)
- Версия операционной системы
- Архитектура процессора
- Время работы системы (uptime)
- Использование памяти
- Использование дискового пространства
- Нагрузка на процессор

**Просмотр логов:**
- Логи Klipper - информация о работе прошивки принтера
- Логи Moonraker - информация о работе веб-сервера
- Системные логи - общие системные сообщения

**Управление сервисами:**
- Запуск, остановка и перезапуск сервисов:
  - Klipper - прошивка принтера
  - Moonraker - веб-сервер и API
  - Nginx - веб-сервер для статических файлов
  - Fluidd - веб-интерфейс (если установлен)

**Файловый менеджер:**
- Просмотр файлов конфигурации Klipper
- Просмотр файлов логов
- Навигация по файловой системе принтера

**Сетевые инструменты:**
- Диагностика сетевого подключения
- Информация о сетевых интерфейсах
- Тестирование подключения к внешним серверам
- Просмотр активных сетевых соединений

**Мониторинг производительности:**
- Статистика использования ресурсов системы
- Детальная информация об использовании памяти
- Информация об использовании дискового пространства
- Список запущенных процессов с использованием ресурсов

**Использование:**
Каждый раздел содержит кнопки для выполнения соответствующих действий. Результаты отображаются в текстовом поле ниже. Используйте кнопку "Очистить" для очистки вывода.

---

### Резервная копия

**Назначение:** Создание и восстановление резервных копий конфигурации принтера

**Функции:**
- Создание резервной копии конфигурации Klipper
- Создание резервной копии базы данных Moonraker
- Восстановление из резервной копии

**Использование:**

**Создание резервной копии:**
1. Перейдите в раздел "Резервная копия"
2. Нажмите "Создать резервную копию"
3. Дождитесь завершения процесса
4. Резервная копия будет сохранена на принтере в специальной директории

**Восстановление из резервной копии:**
1. Убедитесь, что на принтере есть резервная копия
2. Нажмите "Восстановить из резервной копии"
3. Подтвердите действие
4. Дождитесь завершения восстановления
5. Перезапустите соответствующие сервисы

**Рекомендации:**
- Создавайте резервные копии перед любыми значительными изменениями конфигурации
- Регулярно создавайте резервные копии для защиты от потери данных
- Храните резервные копии в безопасном месте

---

### Инструменты

**Назначение:** Дополнительные утилиты для управления принтером

**Доступные инструменты:**

**Управление конфигурацией Klipper:**
- **Предотвратить обновление конфигурационных файлов Klipper** - блокирует автоматическое обновление конфигурации при обновлении прошивки. Полезно для сохранения пользовательских настроек.
- **Разрешить обновление конфигурационных файлов Klipper** - снимает блокировку обновления конфигурации.

**Исправление проблем:**
- **Исправить печать Gcode файлов из папки** - исправляет проблему с печатью файлов, загруженных через веб-интерфейс. Применяется для моделей K1 и Ender-3 V3 серии.

**Управление камерой:**
- **Включить настройки камеры в Moonraker** - активирует интеграцию камеры с Moonraker для просмотра через веб-интерфейс.
- **Выключить настройки камеры в Moonraker** - отключает интеграцию камеры.

**Управление сервисами:**
- **Перезапустить Nginx** - перезапускает веб-сервер Nginx. Используется при проблемах с доступом к веб-интерфейсу.
- **Перезапустить Moonraker** - перезапускает сервис Moonraker. Используется при проблемах с API или веб-интерфейсом.
- **Перезапустить Klipper** - перезапускает прошивку принтера. Используется при проблемах с работой принтера или после изменения конфигурации.

**Обновление системы:**
- **Обновить пакеты Entware** - обновляет установленные пакеты через Entware. Требует установленного Entware.

**Очистка системы:**
- **Очистить системный кэш** - удаляет временные файлы и кэш системы для освобождения места.
- **Очистить логи** - удаляет старые файлы логов для освобождения места на диске.

**Восстановление:**
- **Восстановить предыдущую прошивку** - восстанавливает предыдущую версию прошивки принтера. Требует наличия файла прошивки на USB-накопителе.

**Сброс системы:**
- **Сброс к заводским настройкам** - полностью сбрасывает принтер к заводским настройкам. Удаляет все установленные компоненты и пользовательские настройки. Требует подтверждения.

**Использование:**
1. Выберите нужный инструмент из списка
2. Нажмите на кнопку инструмента
3. При необходимости подтвердите действие
4. Дождитесь завершения операции
5. Проверьте результат в сообщении о статусе

**Внимание:** Некоторые операции (особенно сброс к заводским настройкам) необратимы. Убедитесь, что у вас есть резервная копия перед выполнением критических операций.

---

### Информация

**Назначение:** Информация о приложении и версии

**Содержимое:**
- Версия приложения
- Информация об авторе
- Лицензия
- Ссылки на поддержку и документацию

**Использование:**
Раздел содержит справочную информацию о приложении. Версия приложения обновляется автоматически при каждом релизе.

---

## Языковые настройки

Программа поддерживает два языка интерфейса:
- Русский (по умолчанию)
- Английский

Переключение языка выполняется через кнопки в правом верхнем углу интерфейса. Выбранный язык сохраняется между сеансами работы.

---

## Безопасность

### Валидация данных
- Проверка формата IP адресов (IPv4)
- Валидация портов (диапазон 1-65535)
- Проверка имен пользователей на наличие небезопасных символов
- Защита от XSS атак во всех пользовательских вводах

### SSH соединение
- Безопасное хранение учетных данных (локально на компьютере)
- Поддержка проверки SSH ключей хоста
- Возможность очистки сохраненных SSH ключей

### Рекомендации
- Не передавайте учетные данные SSH третьим лицам
- Регулярно меняйте пароль SSH на принтере
- Используйте программу только в доверенных сетях
- Делайте резервные копии перед выполнением критических операций

---

## Устранение неполадок

### Проблемы с подключением

**Не удается подключиться к принтеру:**
1. Проверьте, что принтер включен и подключен к сети
2. Убедитесь, что IP адрес указан правильно
3. Проверьте, что SSH включен на принтере
4. Попробуйте очистить SSH ключи через кнопку "Очистить SSH"
5. Проверьте настройки файрвола на компьютере и принтере

**Ошибка "Host key verification failed":**
1. Используйте кнопку "Очистить SSH" для удаления старых ключей
2. Попробуйте подключиться снова

### Проблемы с установкой компонентов

**Компонент не устанавливается:**
1. Проверьте подключение к принтеру
2. Убедитесь, что на принтере достаточно свободного места
3. Проверьте логи установки на наличие ошибок
4. Убедитесь, что выбранная модель принтера соответствует реальной модели

**Компонент установлен, но не работает:**
1. Перезапустите соответствующий сервис через раздел "Настройка"
2. Проверьте логи сервиса на наличие ошибок
3. Убедитесь, что все зависимости компонента установлены

### Проблемы с определением модели

**Модель определяется неправильно:**
1. Выберите модель вручную из выпадающего списка в шапке
2. Используйте кнопку "Автоопределение" для повторной попытки
3. Проверьте, что принтер поддерживается программой

---

## Разработка

### Структура проекта

```
hsgui/
├── src/                    # Исходный код приложения
│   ├── main.js            # Основной процесс Electron
│   ├── renderer.js        # Логика интерфейса
│   ├── preload.js         # Безопасный API для рендерера
│   ├── index.html         # HTML структура
│   ├── styles.css         # Стили интерфейса
│   ├── locales/           # Файлы локализации
│   │   ├── ru.json        # Русский язык
│   │   └── en.json        # Английский язык
│   └── utils/             # Вспомогательные утилиты
│       └── i18n.js        # Система локализации
├── scripts/               # Скрипты для принтера
│   ├── upload_script.sh  # Скрипт загрузки файлов
│   ├── install_components.sh # Установка компонентов
│   └── ...                # Другие скрипты
├── original-script/       # Оригинальные скрипты Creality Helper
├── docs/                  # Документация
├── assets/                # Ресурсы (иконки)
└── package.json          # Конфигурация проекта
```

### Сборка релизов

```bash
# Сборка для всех платформ
npm run release:all

# Сборка для конкретной платформы
npm run release:win      # Windows
npm run release:linux    # Linux
npm run release:mac      # macOS
```

Подробнее о создании релизов см. [RELEASE.md](docs/RELEASE.md)

### Тестирование

```bash
# Запуск тестов
npm test

# Запуск тестов в режиме наблюдения
npm run test:watch

# Запуск тестов с покрытием
npm run test:coverage
```

---

## Лицензия

MIT License - см. файл [LICENSE](LICENSE)

---

## Поддержка

Если у вас возникли проблемы или вопросы:

1. Проверьте раздел "Устранение неполадок" выше
2. Изучите документацию в папке `docs/`
3. Создайте [Issue](https://github.com/Tombraider2006/HSGUI_TT/issues) на GitHub с описанием проблемы

---

## Благодарности

Программа основана на оригинальном проекте [Creality-Helper-Script](https://github.com/Guilouz/Creality-Helper-Script.git) от Guilouz.

---

**Последнее обновление:** 2025-01-20  
**Версия:** 0.1.5
